Q1
1. You are given a file named logins.txt, where each line contains a timestamp, a source email, a destination email, and an action. * Write a Bash script named maskUsers.sh that takes two arguments: a filename and an optional number. * If the first argument (filename) is missing, print an error message and exit with status 1. * Your script must then strictly use the sed command to do the following: i. The script must print a header line before any output: # time src dest action ii. If the second argument is 1, print the file content but replace only the first email address in each line with the word USER. iii. If the second argument is not supplied or given any other value, print the file content after replacing both email addresses in each line with the word USER. ./maskUsers.sh logins.txt # time src dest action 12:00 USER USER login 12:05 USER USER logout Sample runs: ./maskUsers.sh logins.txt 1 # time src dest action 12:00 USER bob@udst.edu.qa login 12:05 USER dave@udst.edu.qa logout Remember to submit using the command: test2-submit maskUsers.sh 3 Hints: * You may want to use regular expressions. * Recall that by default, the characters: ?+{|() are not treated as special, they must be escaped.

Q2
1. Given the file threatlist.txt which maps IP addresses to known threat categories, and the file firewall.log which contains firewall connection attempts. * Examine the files to get familiar with the format of each. * Write a Bash script classify.sh that takes the two filenames as arguments and uses only the awk command to do the following. i. Insert a header line in the output that shows: LINE ACTION TIME SRC-IP DEST-IP THREAT ii. Replace the SRC-IP with its corresponding threat category from threatlist.txt. iii. If no match is found, the threat category should be UNKNOWN. Here is a sample run: ./classify.sh threatlist.txt firewall.log LINE ACTION TIME SRC-IP DEST-IP THREAT 1 DROP 12:03 BOTNET 192.168.1.15 BOTNET 2 DROP 12:04 MALWARE 192.168.1.75 MALWARE 3 ALERT 12:06 UNKNOWN 192.168.1.20 UNKNOWN Remember to submit, run the command: test2-submit classify.sh 3

Q3
Given the authentication log file auth.log, note that each line contains a username in the format user=<name>, but it may not always appear at the beginning of the line. 1. Some lines include the keyword SYSTEM, and these lines must be skipped entirely. 2. Write a Python script countU.py that extracts only the usernames from each valid log line and counts how many times each unique username appears in the file. 3. Your script must then write the results to a CSV file named user_stats.csv, where each line contains the username and its count, for example: alice,17 john,42 maria,5 â€¦ Remember to submit, run the command: test2-submit countU.py 3 Hints: * You may want to use regular expressions. * Recall that dictionaries in Python are like associative arrays, they are helpful when storing (key, value) pairs.